---
node_id: LOG-AI-2025-09-19
tags:
  - AI-log
  - development-summary
  - authoring
  - config
  - cli
closed_tickets:
  - AI-IMP-024
  - AI-IMP-025
created_date: 2025-09-19
related_files:
  - src/commands/ai_new/start.rs
  - src/commands/new_helpers.rs
  - src/cli.rs
  - src/bin/cli-rag.rs
  - README.md
  - contracts/changelog.md
  - contracts/global-conventions.md
  - docs/RAG/AI-IMP/AI-IMP-024-output-destination-keys-and-schema-overrides.md
  - docs/RAG/AI-IMP/AI-IMP-025-deprecate-legacy-new-and-migrate-authoring-flows.md
  - tests/integration_ai_new.rs
  - tests/integration_lua_new.rs
confidence_score: 0.87
---

# 2025-09-19-log-ai-ai-first-authoring

## Work Completed
Implemented AI-IMP-024 by adding declarative destination mappings (`[config.authoring.destinations]` and per-schema `output_path`) and wiring the precedence into the AI draft pipeline so submitted notes write inside configured bases. Retired the legacy `cli-rag new` subcommand (AI-IMP-025), migrating authoring tests/docs to the AI-first flow and keeping Lua templating/id overrides functional through `ai new start/submit`. Documented the new behavior across README, contracts references, and IMP plans while updating changelog entries.

## Session Commits
- 53d57d2 – Introduce authoring destinations, update templates/configs, and port tests to exercise the new resolution rules.
- a5226ca – (now superseded) initial deprecation warning for `cli-rag new`.
- 62865ee – Remove the legacy `new` command entirely, move destination/id/frontmatter handling into shared helpers, and shift integration coverage to the AI workflow.

## Issues Encountered
Initial AI draft submission still targeted the first configured base, causing Lua override tests to fail; resolved by reusing the destination resolver inside `ai new start`. Removing the legacy subcommand surfaced stale documentation and acceptance criteria referencing `cli-rag new`; scrubbed downstream ADR/IMP notes and contracts guidance to avoid confusion.

## Tests Added
- tests/integration_ai_new.rs: new cases for global destination mapping, per-schema overrides, and path-traversal rejection through the AI flow.
- tests/integration_lua_new.rs: updated to assert Lua hooks still replace IDs/frontmatter within the AI draft lifecycle.

## Next Steps
Monitor downstream tooling for reliance on the removed subcommand and update any automation to call `cli-rag ai new`. Consider surfacing destination precedence in `cli-rag info` for operator visibility and follow up on IMP-026 to refresh CLI help/completions after the removal.
